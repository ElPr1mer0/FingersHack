#include "encryption.h"
#include <QDebug>





////////////////////////////////////////////////////////////////////////
/////////////////////////ENCRYPT_NUMBER/////////////////////////////////
////////////////////////////////////////////////////////////////////////
// Эта функция кодирует входящие число для шифровки.                  //
QString ENCRYPTION::encryptNumber(float number)
{
    QString str =  QString::number(number);

    for(int i = 0; i<str.length();i++){ // здесь меняем кодировку
        str[i] = QChar(str[i].unicode() + this->kod);
    }

    return str;
}
////////////////////////////////////////////////////////////////////////
/////////////////////////ENCRYPT_NUMBER/////////////////////////////////
////////////////////////////////////////////////////////////////////////





////////////////////////////////////////////////////////////////////////
/////////////////////////DE_ENCRYPT_NUMBER//////////////////////////////
////////////////////////////////////////////////////////////////////////
// Эта функция декодирует входящий шифр для получения числа.          //
float ENCRYPTION::deEncryptNumber(QString str)
{
    for(int j = 0; j<str.length();j++){ // здесь возвращаем исходную кодировку
        str[j] = QChar(str[j].unicode() - this->kod);
    }

    bool isNumber = false;
    if(str.toFloat(&isNumber)||str=="0") {  // проверка на число, если это не число, тогда файл был поврежден, возвращаем 0
                                // п.с. toInt(&isNumber) считает 0 не числом, поэтому возвращает false, поэтому доп проверка на str=="0"
        float number = str.toFloat();
        return number;
    }
    else{
        qDebug()<<"Number translation error! File have damaged!";
        return this->translateError;
    }
}
////////////////////////////////////////////////////////////////////////
/////////////////////////DE_ENCRYPT_NUMBER//////////////////////////////
////////////////////////////////////////////////////////////////////////





////////////////////////////////////////////////////////////////////////
///////////////////////GET_TRANSLATE_ERROR//////////////////////////////
////////////////////////////////////////////////////////////////////////
// Эта функция возвращает код ошибки, возникающий при шифровке        //
int ENCRYPTION::getTranslateError()
{
    return this->translateError;
}
////////////////////////////////////////////////////////////////////////
///////////////////////GET_TRANSLATE_ERROR//////////////////////////////
////////////////////////////////////////////////////////////////////////
